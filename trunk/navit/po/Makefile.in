PO-FILES=de.po fr.po pl.po it.po
LANGUAGES=$(PO-FILES:.po=)

# Maybe this should be autogenerated by "configure".
LOCALEDIR=@LOCALEDIR@

# If other files will be translated, they must be also here:
CSOURCES=../src/main.c ../src/navigation.c


MO-FILES = $(LANGUAGES:=.mo)

all: $(MO-FILES)

install: $(MO-FILES)
	@for i in $(LANGUAGES); do \
	 /usr/bin/install -c -d $(DESTDIR)$(LOCALEDIR)/$$i/LC_MESSAGES; \
	 /usr/bin/install -c -m 444 $$i.mo $(DESTDIR)$(LOCALEDIR)/$$i/LC_MESSAGES/xaos.mo; \
	 done

clean:
	rm -f $(MO-FILES)

distclean: clean
	rm Makefile

messages.pot: $(CSOURCES)
	/usr/bin/xgettext -o navit.pot $(CSOURCES)

$(PO-FILES): navit.pot
	test -e $@
	/usr/bin/msgmerge $@ navit.pot > $@.new
	mv $@.new $@

$(MO-FILES): $(PO-FILES)
	/usr/bin/msgfmt -o $@ -c -v --statistics $(@:.mo=.po)

new-languages: Makefile
	@for i in $(LANGUAGES); do \
	 test -e $$i.po || cp navit.pot $$i.po; \
	 done
